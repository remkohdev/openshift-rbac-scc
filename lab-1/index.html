
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="IBM Developer">
      
      
        <link rel="canonical" href="https://github.com/IBM/openshift-rbac-scc/lab-1/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.10">
    
    
      
        <title>Lab 1. OpenShift RBAC - OpenShift RBAC</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1fe995fd.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback">
        <style>:root{--md-text-font-family:"IBM Plex Sans";--md-code-font-family:"IBM Plex Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openshift-rbac-with-serviceaccounts-and-securitycontextconstraints" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OpenShift RBAC" class="md-header__button md-logo" aria-label="OpenShift RBAC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="180" height="85" version="1.1" viewBox="0 0 180 85"><title>ibm_8bar_gray10_on_teal90</title><g id="Page-1" fill="none" fill-rule="evenodd" stroke="none" stroke-width="1"><g id="ibm_8bar_gray10_on_teal90" fill-rule="nonzero"><rect id="Rectangle-5-Copy-14" width="180" height="85" x="0" y="0" fill="#000"/><g id="8-bar-/-reverse" fill="#F3F3F3" transform="translate(8.500000, 9.500000)"><path id="Combined-Shape" d="M31.6944444,60.7545455 L31.6944444,64.8707071 L1.70388148e-11,64.8707071 L1.70388148e-11,60.7545455 L31.6944444,60.7545455 Z M80.7590909,60.7545455 C77.7542929,63.3065657 73.8439394,64.8707071 69.5631313,64.8707071 L69.5631313,64.8707071 L36.2222222,64.8707071 L36.2222222,60.7545455 L80.7590909,60.7545455 Z M113.194444,60.7133838 L113.194444,64.8295455 L90.5555556,64.8295455 L90.5555556,60.7133838 L113.194444,60.7133838 Z M163,60.7133838 L163,64.8295455 L140.361111,64.8295455 L140.361111,60.7133838 L163,60.7133838 Z M128.218434,60.7133838 L126.777778,64.7883838 L125.337121,60.7133838 L128.218434,60.7133838 Z M86.2747475,52.1106061 C85.8631313,53.5512626 85.2868687,54.9507576 84.5459596,56.2267677 L84.5459596,56.2267677 L36.2222222,56.2267677 L36.2222222,52.1106061 L86.2747475,52.1106061 Z M31.6944444,52.1106061 L31.6944444,56.2267677 L1.70388148e-11,56.2267677 L1.70388148e-11,52.1106061 L31.6944444,52.1106061 Z M113.194444,52.0694444 L113.194444,56.1856061 L90.5555556,56.1856061 L90.5555556,52.0694444 L113.194444,52.0694444 Z M163,52.0694444 L163,56.1856061 L140.361111,56.1856061 L140.361111,52.0694444 L163,52.0694444 Z M131.264394,52.0694444 L129.823737,56.1856061 L123.731818,56.1856061 L122.291162,52.0694444 L131.264394,52.0694444 Z M22.6388889,43.4666667 L22.6388889,47.5828283 L9.05555556,47.5828283 L9.05555556,43.4666667 L22.6388889,43.4666667 Z M58.8611111,43.4666667 L58.8611111,47.5828283 L45.2777778,47.5828283 L45.2777778,43.4666667 L58.8611111,43.4666667 Z M86.3570707,43.4666667 C86.6863636,44.7838384 86.8510101,46.1833333 86.8510101,47.5828283 L86.8510101,47.5828283 L72.4444444,47.5828283 L72.4444444,43.4666667 L86.3570707,43.4666667 Z M113.194444,43.4255051 L113.194444,47.5416667 L99.6111111,47.5416667 L99.6111111,43.4255051 L113.194444,43.4255051 Z M153.944444,43.4255051 L153.944444,47.5416667 L140.361111,47.5416667 L140.361111,43.4255051 L153.944444,43.4255051 Z M134.310354,43.4255051 L132.869697,47.5416667 L120.685859,47.5416667 L119.245202,43.4255051 L134.310354,43.4255051 Z M22.6388889,34.8227273 L22.6388889,38.9388889 L9.05555556,38.9388889 L9.05555556,34.8227273 L22.6388889,34.8227273 Z M81.2118687,34.8227273 C82.5290404,35.9752525 83.640404,37.3747475 84.5459596,38.9388889 L84.5459596,38.9388889 L45.2777778,38.9388889 L45.2777778,34.8227273 L81.2118687,34.8227273 Z M113.194444,34.7815657 L113.194444,38.8977273 L99.6111111,38.8977273 L99.6111111,34.7815657 L113.194444,34.7815657 Z M153.944444,34.7815657 L153.944444,38.8977273 L140.361111,38.8977273 L140.361111,34.7815657 L153.944444,34.7815657 Z M137.397475,34.7815657 L135.915657,38.8977273 L117.639899,38.8977273 L116.158081,34.7815657 L137.397475,34.7815657 Z M22.6388889,26.1787879 L22.6388889,30.2949495 L9.05555556,30.2949495 L9.05555556,26.1787879 L22.6388889,26.1787879 Z M84.5459596,26.1787879 C83.640404,27.7017677 82.5290404,29.1012626 81.2118687,30.2949495 L81.2118687,30.2949495 L45.2777778,30.2949495 L45.2777778,26.1787879 L84.5459596,26.1787879 Z M153.944444,26.1376263 L153.944444,30.2537879 L140.361111,30.2537879 L140.361111,26.3434343 L138.961616,30.2537879 L127.065909,30.2537879 L128.465404,26.1376263 L153.944444,26.1376263 Z M125.090152,26.1376263 L126.489646,30.2537879 L114.593939,30.2537879 L113.194444,26.3434343 L113.194444,30.2537879 L99.6111111,30.2537879 L99.6111111,26.1376263 L125.090152,26.1376263 Z M22.6388889,17.5348485 L22.6388889,21.6510101 L9.05555556,21.6510101 L9.05555556,17.5348485 L22.6388889,17.5348485 Z M58.8611111,17.5348485 L58.8611111,21.6510101 L45.2777778,21.6510101 L45.2777778,17.5348485 L58.8611111,17.5348485 Z M86.8510101,17.5348485 C86.8510101,18.9343434 86.6863636,20.3338384 86.3570707,21.6510101 L86.3570707,21.6510101 L72.4444444,21.6510101 L72.4444444,17.5348485 L86.8510101,17.5348485 Z M153.944444,17.4936869 L153.944444,21.6098485 L130.070707,21.6098485 L131.470202,17.4936869 L153.944444,17.4936869 Z M122.085354,17.4936869 L123.484848,21.6098485 L99.6111111,21.6098485 L99.6111111,17.4936869 L122.085354,17.4936869 Z M31.6944444,8.89090909 L31.6944444,13.0070707 L1.70388148e-11,13.0070707 L1.70388148e-11,8.89090909 L31.6944444,8.89090909 Z M84.504798,8.89090909 C85.2457071,10.1669192 85.8219697,11.5664141 86.2335859,13.0070707 L86.2335859,13.0070707 L36.2222222,13.0070707 L36.2222222,8.89090909 L84.504798,8.89090909 Z M163,8.84974747 L163,12.9659091 L133.034343,12.9659091 L134.475,8.84974747 L163,8.84974747 Z M119.080556,8.84974747 L120.521212,12.9659091 L90.5555556,12.9659091 L90.5555556,8.84974747 L119.080556,8.84974747 Z M31.6944444,0.246969697 L31.6944444,4.36313131 L1.70388148e-11,4.36313131 L1.70388148e-11,0.246969697 L31.6944444,0.246969697 Z M69.5631313,0.246969697 L70.0046301,0.252525646 C74.1125422,0.356016166 77.8579067,1.89911181 80.7590909,4.36313131 L80.7590909,4.36313131 L36.2222222,4.36313131 L36.2222222,0.246969697 L69.5631313,0.246969697 Z M163,0.205808081 L163,4.3219697 L136.039141,4.3219697 L137.479798,0.205808081 L163,0.205808081 Z M116.075758,0.205808081 L117.516414,4.3219697 L90.5555556,4.3219697 L90.5555556,0.205808081 L116.075758,0.205808081 Z"/></g></g></g></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenShift RBAC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 1. OpenShift RBAC
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/IBM/openshift-rbac-scc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openshift-rbac-scc
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        Welcome
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Workshop
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../resources/RESOURCES/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenShift RBAC" class="md-nav__button md-logo" aria-label="OpenShift RBAC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="180" height="85" version="1.1" viewBox="0 0 180 85"><title>ibm_8bar_gray10_on_teal90</title><g id="Page-1" fill="none" fill-rule="evenodd" stroke="none" stroke-width="1"><g id="ibm_8bar_gray10_on_teal90" fill-rule="nonzero"><rect id="Rectangle-5-Copy-14" width="180" height="85" x="0" y="0" fill="#000"/><g id="8-bar-/-reverse" fill="#F3F3F3" transform="translate(8.500000, 9.500000)"><path id="Combined-Shape" d="M31.6944444,60.7545455 L31.6944444,64.8707071 L1.70388148e-11,64.8707071 L1.70388148e-11,60.7545455 L31.6944444,60.7545455 Z M80.7590909,60.7545455 C77.7542929,63.3065657 73.8439394,64.8707071 69.5631313,64.8707071 L69.5631313,64.8707071 L36.2222222,64.8707071 L36.2222222,60.7545455 L80.7590909,60.7545455 Z M113.194444,60.7133838 L113.194444,64.8295455 L90.5555556,64.8295455 L90.5555556,60.7133838 L113.194444,60.7133838 Z M163,60.7133838 L163,64.8295455 L140.361111,64.8295455 L140.361111,60.7133838 L163,60.7133838 Z M128.218434,60.7133838 L126.777778,64.7883838 L125.337121,60.7133838 L128.218434,60.7133838 Z M86.2747475,52.1106061 C85.8631313,53.5512626 85.2868687,54.9507576 84.5459596,56.2267677 L84.5459596,56.2267677 L36.2222222,56.2267677 L36.2222222,52.1106061 L86.2747475,52.1106061 Z M31.6944444,52.1106061 L31.6944444,56.2267677 L1.70388148e-11,56.2267677 L1.70388148e-11,52.1106061 L31.6944444,52.1106061 Z M113.194444,52.0694444 L113.194444,56.1856061 L90.5555556,56.1856061 L90.5555556,52.0694444 L113.194444,52.0694444 Z M163,52.0694444 L163,56.1856061 L140.361111,56.1856061 L140.361111,52.0694444 L163,52.0694444 Z M131.264394,52.0694444 L129.823737,56.1856061 L123.731818,56.1856061 L122.291162,52.0694444 L131.264394,52.0694444 Z M22.6388889,43.4666667 L22.6388889,47.5828283 L9.05555556,47.5828283 L9.05555556,43.4666667 L22.6388889,43.4666667 Z M58.8611111,43.4666667 L58.8611111,47.5828283 L45.2777778,47.5828283 L45.2777778,43.4666667 L58.8611111,43.4666667 Z M86.3570707,43.4666667 C86.6863636,44.7838384 86.8510101,46.1833333 86.8510101,47.5828283 L86.8510101,47.5828283 L72.4444444,47.5828283 L72.4444444,43.4666667 L86.3570707,43.4666667 Z M113.194444,43.4255051 L113.194444,47.5416667 L99.6111111,47.5416667 L99.6111111,43.4255051 L113.194444,43.4255051 Z M153.944444,43.4255051 L153.944444,47.5416667 L140.361111,47.5416667 L140.361111,43.4255051 L153.944444,43.4255051 Z M134.310354,43.4255051 L132.869697,47.5416667 L120.685859,47.5416667 L119.245202,43.4255051 L134.310354,43.4255051 Z M22.6388889,34.8227273 L22.6388889,38.9388889 L9.05555556,38.9388889 L9.05555556,34.8227273 L22.6388889,34.8227273 Z M81.2118687,34.8227273 C82.5290404,35.9752525 83.640404,37.3747475 84.5459596,38.9388889 L84.5459596,38.9388889 L45.2777778,38.9388889 L45.2777778,34.8227273 L81.2118687,34.8227273 Z M113.194444,34.7815657 L113.194444,38.8977273 L99.6111111,38.8977273 L99.6111111,34.7815657 L113.194444,34.7815657 Z M153.944444,34.7815657 L153.944444,38.8977273 L140.361111,38.8977273 L140.361111,34.7815657 L153.944444,34.7815657 Z M137.397475,34.7815657 L135.915657,38.8977273 L117.639899,38.8977273 L116.158081,34.7815657 L137.397475,34.7815657 Z M22.6388889,26.1787879 L22.6388889,30.2949495 L9.05555556,30.2949495 L9.05555556,26.1787879 L22.6388889,26.1787879 Z M84.5459596,26.1787879 C83.640404,27.7017677 82.5290404,29.1012626 81.2118687,30.2949495 L81.2118687,30.2949495 L45.2777778,30.2949495 L45.2777778,26.1787879 L84.5459596,26.1787879 Z M153.944444,26.1376263 L153.944444,30.2537879 L140.361111,30.2537879 L140.361111,26.3434343 L138.961616,30.2537879 L127.065909,30.2537879 L128.465404,26.1376263 L153.944444,26.1376263 Z M125.090152,26.1376263 L126.489646,30.2537879 L114.593939,30.2537879 L113.194444,26.3434343 L113.194444,30.2537879 L99.6111111,30.2537879 L99.6111111,26.1376263 L125.090152,26.1376263 Z M22.6388889,17.5348485 L22.6388889,21.6510101 L9.05555556,21.6510101 L9.05555556,17.5348485 L22.6388889,17.5348485 Z M58.8611111,17.5348485 L58.8611111,21.6510101 L45.2777778,21.6510101 L45.2777778,17.5348485 L58.8611111,17.5348485 Z M86.8510101,17.5348485 C86.8510101,18.9343434 86.6863636,20.3338384 86.3570707,21.6510101 L86.3570707,21.6510101 L72.4444444,21.6510101 L72.4444444,17.5348485 L86.8510101,17.5348485 Z M153.944444,17.4936869 L153.944444,21.6098485 L130.070707,21.6098485 L131.470202,17.4936869 L153.944444,17.4936869 Z M122.085354,17.4936869 L123.484848,21.6098485 L99.6111111,21.6098485 L99.6111111,17.4936869 L122.085354,17.4936869 Z M31.6944444,8.89090909 L31.6944444,13.0070707 L1.70388148e-11,13.0070707 L1.70388148e-11,8.89090909 L31.6944444,8.89090909 Z M84.504798,8.89090909 C85.2457071,10.1669192 85.8219697,11.5664141 86.2335859,13.0070707 L86.2335859,13.0070707 L36.2222222,13.0070707 L36.2222222,8.89090909 L84.504798,8.89090909 Z M163,8.84974747 L163,12.9659091 L133.034343,12.9659091 L134.475,8.84974747 L163,8.84974747 Z M119.080556,8.84974747 L120.521212,12.9659091 L90.5555556,12.9659091 L90.5555556,8.84974747 L119.080556,8.84974747 Z M31.6944444,0.246969697 L31.6944444,4.36313131 L1.70388148e-11,4.36313131 L1.70388148e-11,0.246969697 L31.6944444,0.246969697 Z M69.5631313,0.246969697 L70.0046301,0.252525646 C74.1125422,0.356016166 77.8579067,1.89911181 80.7590909,4.36313131 L80.7590909,4.36313131 L36.2222222,4.36313131 L36.2222222,0.246969697 L69.5631313,0.246969697 Z M163,0.205808081 L163,4.3219697 L136.039141,4.3219697 L137.479798,0.205808081 L163,0.205808081 Z M116.075758,0.205808081 L117.516414,4.3219697 L90.5555556,4.3219697 L90.5555556,0.205808081 L116.075758,0.205808081 Z"/></g></g></g></svg>

    </a>
    OpenShift RBAC
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/IBM/openshift-rbac-scc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openshift-rbac-scc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Welcome
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Welcome" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Welcome
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        About the workshop
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Workshop
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Workshop" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Workshop
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lab 1. OpenShift RBAC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lab 1. OpenShift RBAC
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-authorization-and-user-permissions" class="md-nav__link">
    Section 1: Authorization and User Permissions
  </a>
  
    <nav class="md-nav" aria-label="Section 1: Authorization and User Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    Steps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-container-permissions-and-sccs" class="md-nav__link">
    Section 2: Container Permissions and SCCs
  </a>
  
    <nav class="md-nav" aria-label="Section 2: Container Permissions and SCCs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_1" class="md-nav__link">
    Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps_1" class="md-nav__link">
    Steps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        References
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="References" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../resources/RESOURCES/" class="md-nav__link">
        Additional Resources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../resources/CONTRIBUTORS/" class="md-nav__link">
        Contributors
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-authorization-and-user-permissions" class="md-nav__link">
    Section 1: Authorization and User Permissions
  </a>
  
    <nav class="md-nav" aria-label="Section 1: Authorization and User Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    Steps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-container-permissions-and-sccs" class="md-nav__link">
    Section 2: Container Permissions and SCCs
  </a>
  
    <nav class="md-nav" aria-label="Section 2: Container Permissions and SCCs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_1" class="md-nav__link">
    Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps_1" class="md-nav__link">
    Steps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/IBM/openshift-rbac-scc/edit/master/docs/lab-1/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="openshift-rbac-with-serviceaccounts-and-securitycontextconstraints">OpenShift RBAC with ServiceAccounts and SecurityContextConstraints<a class="headerlink" href="#openshift-rbac-with-serviceaccounts-and-securitycontextconstraints" title="Permanent link">&para;</a></h1>
<p>When discussing container application security on OpenShift there are multiple layers that you should to take into consideration. According to <a href="https://www.redhat.com/en/resources/layered-approach-security-detail">Red Hat</a>, the layers to be considered include:</p>
<ul>
<li>Building security into applications - Using secure and trusted container images, using private image registries</li>
<li>Manage configuration, security, and compliance of applications - <strong>Identity and access management</strong>, platform configuration, <strong>policy based deployments</strong></li>
<li>Protecting running applications - Ensuring container isolation, application and network isolation</li>
</ul>
<p>In this lab we will be exploring <strong>identity and access managment</strong> by creating a service account with limited permissions and <strong>policy based deployments</strong> by creating a custom SecurityContextConstraint that a pod must abide by in order to be deployed.</p>
<p>This lab is comprised of the following sections:</p>
<ol>
<li><a href="#Setup">Setup</a></li>
<li><a href="#Section-1:-Authorization-and-User-Permissions">Section 1: Authorization and User Permissions</a></li>
<li><a href="#Section-2:-Container-Permissions-and-SCCs">Section 2: Container Permissions and SCCs</a></li>
</ol>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<p>The following must be done before you can get started on the lab.</p>
<ol>
<li>
<p>Gain access to your lab environment by following the steps found <a href="https://ibm.github.io/workshop-setup/GRANTCLUSTER/" target="_blank">here</a></p>
</li>
<li>
<p>As mentioned in the link above, you can use the IBM Cloud Shell for the workshop which can be accessed here: <a href="https://cloud.ibm.com/shell" target="_blank">https://cloud.ibm.com/shell</a></p>
</li>
<li>
<p>Once in the terminal, clone the workshop repository by entering:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/IBM/openshift-rbac-scc.git
<span class="nb">cd</span> openshift-rbac-scc/src
</code></pre></div>
</li>
</ol>
<h2 id="section-1-authorization-and-user-permissions">Section 1: Authorization and User Permissions<a class="headerlink" href="#section-1-authorization-and-user-permissions" title="Permanent link">&para;</a></h2>
<h3 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h3>
<p>Users in OpenShift are only allowed to perform actions that are defined in the <strong>Roles</strong> or <strong>ClusterRoles</strong> that they are assigned. <strong>Roles</strong> can be thought of as a list of rules in the form of verbs ("get", "create", "list", "delete", etc.) and the resources that they apply to (pods, projects, deployments, users, etc.) within a single project. <strong>ClusterRoles</strong> are the same concept as <strong>Roles</strong> but are available in all projects.</p>
<p>A <strong>RoleBinding</strong> ties a <strong>Role</strong> or <strong>ClusterRole</strong> to a user to a single project while a <strong>ClusterRoleBinding</strong> ties a <strong>ClusterRole</strong> to a user and is available across all projects.</p>
<p>The same permissions process mentioned above with <strong>Roles</strong> and <strong>RoleBindings</strong> for a user is also true for <strong>ServiceAccounts</strong>. <strong>ServiceAccounts</strong> are accounts in a cluster that can view and manage resources through the Kubernetes API without being tied to users. This makes <strong>ServiceAccounts</strong> ideal for applications or operators that need to view or manage cluster resources.</p>
<p>This diagram from the <a href="https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html">OpenShift documentation</a> summarizes RBAC policies:</p>
<p><img alt="RBACDiagram" src="../images/RBACDiagram.png" /></p>
<p>In this first section of the lab we will be creating a <code>helper</code> <strong>ServiceAccount</strong> that can be used to monitor cluster resources in project named <code>rbac-project</code>. We will be going through the following steps:</p>
<ul>
<li>Creating a <strong>ServiceAccount</strong></li>
<li>Viewing built-in <strong>ClusterRoles</strong></li>
<li>Creating a <strong>RoleBinding</strong> between the <code>view</code> <strong>ClusterRole</strong> and the <code>helper</code> <strong>ServiceAccount</strong></li>
<li>Authenticating as the <strong>ServiceAccount</strong> and testing permissions</li>
</ul>
<h3 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Log into your cluster by following the <a href="https://ibm.github.io/workshop-setup/ROKS/#login-to-openshift" target="_blank">steps outlined here</a>.</p>
</li>
<li>
<p>It is recommended that you create a new project when deploying applications rather than working in the <code>default</code> project so let's create one.</p>
<div class="highlight"><pre><span></span><code>oc new-project rbac-project
</code></pre></div>
<p>You will automatically target the new project with subsequent <code>oc</code> commands.</p>
</li>
<li>
<p>Each new project that is created contains 3 Service Accounts. Let's take a look at them:</p>
<div class="highlight"><pre><span></span><code>oc get sa
</code></pre></div>
<p>You should see three listed:</p>
<div class="highlight"><pre><span></span><code>NAME        SECRETS   AGE
builder     <span class="m">2</span>         77m
default     <span class="m">2</span>         77m
deployer    <span class="m">2</span>         77m
</code></pre></div>
<p>Each service account has it's own purpose:</p>
<ul>
<li>builder: Used when running <code>build</code> pods</li>
<li>deployer: Used when running <code>deploy</code> pods</li>
<li>default: Default service account used if none is specified in the pod template</li>
</ul>
<p>We will actually see an example of a build pod later but it is typically used with the <code>oc new-app</code> and <code>oc start-build</code> commands.</p>
</li>
<li>
<p>Create a service account</p>
<div class="highlight"><pre><span></span><code>oc create sa helper
</code></pre></div>
<p>In our fake example, this service account will be used to view the resources that are running on our cluster by querying the underlying Kubernetes API.</p>
</li>
<li>
<p>View the service accounts again:</p>
<div class="highlight"><pre><span></span><code>oc get sa
</code></pre></div>
<p>You should now see:</p>
<div class="highlight"><pre><span></span><code>NAME       SECRETS   AGE
builder    <span class="m">2</span>         133m
default    <span class="m">2</span>         133m
deployer   <span class="m">2</span>         133m
helper     <span class="m">2</span>         132m
</code></pre></div>
</li>
<li>
<p>Let's authenticate with the API to see what permissions our new Service Account has:</p>
<ol>
<li>Switch to your terminal and paste in <code>export TOKEN=</code> without entering yet.</li>
<li>
<p>Navigate back to your OpenShift Console that should be open in another browser tab.</p>
</li>
<li>
<p>Click on <code>User Management</code> to expand the menu then click on <code>Service Accounts</code></p>
<p><img alt="service accounts" src="../images/serviceAccounts.png" /></p>
</li>
<li>
<p>In the service accounts page, select <code>rbac-project</code> from the <code>Project</code> dropdown near the top of the page above the heading <code>Service Accounts</code>.</p>
</li>
<li>
<p>In the list of service accounts, click on <code>helper</code></p>
<p><img alt="helper" src="../images/helper.png" /></p>
</li>
<li>
<p>Scroll down to the area labeled <code>Secrets</code> and click on the secret that starts with <code>helper-token</code>.</p>
<p><img alt="helperTokenName" src="../images/helperTokenName.png" /></p>
</li>
<li>
<p>On the secret page, scroll down and find the data field labeled <code>token</code></p>
</li>
<li>
<p>Click on the copy icon on the right of the <code>token</code> field.</p>
<p><img alt="helperToken" src="../images/helperToken.png" /></p>
</li>
<li>
<p>Switch back to your terminal and paste in the token. It should be a really long string of characters. It will look something like:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">TOKEN</span><span class="o">=</span>eyJhbGciOiJSUzI1NiIsImtpZCI6ImJrOUYzcUhSaGEwMk9mMXZMcWppWVpuZWdCQjBjcVM1d3ZJRk13ODluTGsifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJyYmFjLXByb2plY3QiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiaGVscGVyLXRva2VuLXo5eDJ3Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImhlbHBlciIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImM4M2RiMDFiLWRiOTAtNGI2NS1iZWVkLWU4YzU2ZTM2ODkwNiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpyYmFjLXByb2plY3Q6aGVscGVyIn0.JFw8vgrgVJhjAuP_8L5JVkPFPfK2w11Rzevi56qPlYvpUPaW4XJdVv3y3_8ieUWNGkWALO25--oj8Bqb8NYQ8mJuvh1D2vRL743iwJ8-fLah9KJO0wXe-OKNWNZAizSuz2EH3uJHpP6FqVJ8I-a0h015caS5VtrA16dSmShTer1i1JpSO8NxtUgnZLQtzfnkaclKyvvIFF8xcby83r8SWZGyGB7mxH7jQ5zdyw1cLwBgIXVXuSOpJA_4JmLMo3CZ2q8H-Nq20_3mD548z-fvv9vUxwgGSLTR1WGTPb2XDC5pEt3vF0oZULez406PHmF5Hd5fdLV2XGWXE1fHnnNoEA
</code></pre></div>
</li>
<li>
<p>Then press enter</p>
</li>
</ol>
<p>Now that we have the token we need the server address of the cluster that we are authenticating with.</p>
<ol>
<li>In your terminal paste in <code>export SERVER=</code> without entering yet.</li>
<li>
<p>Open up the <code>Copy login command</code> tab again and copy the server address.</p>
<p><img alt="serverAddress" src="../images/server.png" /></p>
</li>
<li>
<p>Go back to your terminal and paste in the server address so that the entire command reads something like:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">SERVER</span><span class="o">=</span>https://c104-e.us-east.containers.cloud.ibm.com:30166
</code></pre></div>
<p>Then press enter.</p>
</li>
<li>
<p>Now let's authenticate to the cluster as our <code>helper</code> service account:</p>
<div class="highlight"><pre><span></span><code>oc login --server<span class="o">=</span><span class="nv">$SERVER</span> --token<span class="o">=</span><span class="nv">$TOKEN</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>As the new service account, try retrieving a list of all projects</p>
<div class="highlight"><pre><span></span><code>oc get projects
</code></pre></div>
</li>
<li>
<p>How about getting all resources?</p>
<div class="highlight"><pre><span></span><code>oc get all
</code></pre></div>
<p>You should see a bunch of errors regarding resources that this service account does not have access to. This is good as it means our permissions are working as intended.</p>
</li>
<li>
<p>Let's switch back to our own user account. Copy the login command from the <code>Copy login command</code> tab again.</p>
</li>
<li>
<p>To give our new service account some permissions we will assign it the ClusterRole of <code>view</code>. This will allow <code>helper</code> to view the resources on the cluster without being able to modify anything. </p>
<p>First take a look at what permissions exactly we are giving <code>helper</code>:</p>
<div class="highlight"><pre><span></span><code>oc project rbac-project
oc describe clusterrole view
</code></pre></div>
<p>This looks like the ideal list of permissions for <code>helper</code> so let's grant him the ClusterRole.</p>
<div class="highlight"><pre><span></span><code>oc adm policy add-cluster-role-to-user view -z helper
</code></pre></div>
</li>
<li>
<p>Now let's deploy something for <code>helper</code> to view.</p>
<div class="highlight"><pre><span></span><code>oc new-app ruby~https://github.com/sclorg/ruby-ex.git
</code></pre></div>
<p>This will create a simple ruby application for us. Remember when I mentioned that we would see build pods? Here is where they come into play. A build pod will build the sample app using the <code>builder</code> service account and will stop running when it is done and the application pods will then be available. There is a lot to go into regarding OpenShift builds but since that isn't the focus of this lab, we will leave that for another time.</p>
</li>
<li>
<p>Go to your terminal and login as <code>helper</code> again.</p>
<div class="highlight"><pre><span></span><code>oc login --server<span class="o">=</span><span class="nv">$SERVER</span> --token<span class="o">=</span><span class="nv">$TOKEN</span>
</code></pre></div>
</li>
<li>
<p>Now try running the following commands:</p>
<div class="highlight"><pre><span></span><code>oc get projects
</code></pre></div>
<div class="highlight"><pre><span></span><code>oc get pods -n rbac-project
</code></pre></div>
<p>If our permissions are correct, <code>helper</code> can view the pods we just spun up with our user account.</p>
<p>What if we try deploying something as <code>helper</code>?</p>
<div class="highlight"><pre><span></span><code>oc new-app ruby~https://github.com/sclorg/ruby-ex.git
</code></pre></div>
<p>Notice in the <code>Creating Resources section</code> of the output that every resource failed to create due to the permissions that we have set.</p>
</li>
</ol>
<p>In summary, we create a new service account for a <code>helper</code> that would be able to monitor workloads on our cluster and we assigned a limited ClusterRole of <code>view</code> that would ensure that it only has read access to our resources.</p>
<h2 id="section-2-container-permissions-and-sccs">Section 2: Container Permissions and SCCs<a class="headerlink" href="#section-2-container-permissions-and-sccs" title="Permanent link">&para;</a></h2>
<h3 id="introduction_1">Introduction<a class="headerlink" href="#introduction_1" title="Permanent link">&para;</a></h3>
<p>In the previous section we discussed permissions using RBAC with <strong>Roles</strong> and <strong>RoleBindings</strong> to restrict what a user or <strong>ServiceAccount</strong> could do and now in this section we will take a look at using RBAC policies with <strong>SecurityContextConstraints</strong> (SCC) to restrict what a pod can do. </p>
<p><strong>SecurityContextConstraints</strong> restrict what a pod has access to and in order for a pod to be deployed, it must abide by the conditions outlined in the SCC. OpenShift comes with a few SCCs built in such as:</p>
<ul>
<li>anyuid</li>
<li>hostaccess</li>
<li>hostmount-anyuid</li>
<li>hostnetwork </li>
<li>node-exporter</li>
<li>nonroot</li>
<li>privileged</li>
<li>restricted (default)</li>
</ul>
<p>In OpenShift, a deployed pod will run under the <code>default</code> <strong>ServiceAccount</strong> unless a specific <strong>ServiceAccountName</strong> is listed in the pod template. The pod uses the SCC of the attached <strong>ServiceAccount</strong> to determine if the pod can be deployed. In this case, <code>default</code> uses the <code>restricted</code> SCC which is the most locked-down SCC.</p>
<p>The <code>restricted</code> SCC should work for most workloads but if you need to create your own, this lab will show you how.</p>
<p>For more on SCCs, check out the <a href="https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html">OpenShift Docs</a>.</p>
<p>We will be building upon concepts that were covered in the previous section so I recommend going through Section 1 first.</p>
<p>In this section we will:</p>
<ul>
<li>Examine the <code>restricted</code> SCC</li>
<li>Create a custom SCC</li>
<li>Create a <strong>ServiceAccount</strong> that we will add the SCC to</li>
<li>Create a <strong>Role</strong> that allows use of the custom SCC</li>
<li>Create a <strong>RoleBinding</strong> between the new <strong>Role</strong> and <strong>ServiceAccount</strong></li>
<li>Test out the new restrictions</li>
</ul>
<h3 id="steps_1">Steps<a class="headerlink" href="#steps_1" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Let's log back into our own user account. Copy the login command from the <code>Copy Login Command</code> tab again.</p>
</li>
<li>
<p>Create a new project for this section</p>
<div class="highlight"><pre><span></span><code>oc new-project scc-project
</code></pre></div>
</li>
<li>
<p>Examine the default <code>restricted</code> scc.</p>
<div class="highlight"><pre><span></span><code>oc describe scc restricted
</code></pre></div>
<p>Notice how many of the permissions under <code>Settings</code> are disabled such as <code>Allow Privileged</code>, <code>Allow Host Network</code>, <code>Allow Host PID</code>, and more. </p>
<p>One of the few things not restricted in this list is <code>Read Only Root Filesystem</code>. This setting will make the running pod completely immutable and unable to be written to at all. Usually, permissions in the Linux OS within the pod will prevent the user from writing to the important directories, but if you really want a secure locked down pod you can set <code>Read Only Root Filesystem</code> to true and make the pod completely read-only.</p>
<p>Before we create a custom read-only SCC let's see what a pod looks like running with the default <code>restricted</code> SCC.</p>
</li>
<li>
<p>Create a deployment with the default SCC.</p>
<div class="highlight"><pre><span></span><code>oc create -f RHELDeploy.yaml
</code></pre></div>
</li>
<li>
<p>Find the pod name that was just deployed</p>
<div class="highlight"><pre><span></span><code>oc get pods
</code></pre></div>
</li>
<li>
<p>Then, exec into the pod by running the following while replacing <code>{pod name}</code> with the actual pod name from the previous command:</p>
<div class="highlight"><pre><span></span><code>oc <span class="nb">exec</span> -it <span class="o">{</span>pod name<span class="o">}</span> -- bash
</code></pre></div>
</li>
<li>
<p>Once inside the pod, try the following:</p>
<div class="highlight"><pre><span></span><code>touch test.txt
</code></pre></div>
<p>This should fail as RHEL has a lot of security in place to ensure that users do not have access to most locations.</p>
<p>Now try this:</p>
<div class="highlight"><pre><span></span><code>touch tmp/test.txt
</code></pre></div>
<p>This should work.</p>
<p>Let's lock down the image even more by making the image read-only.</p>
<p>Exit the pod by entering <code>exit</code></p>
</li>
<li>
<p>Delete the deployment</p>
<div class="highlight"><pre><span></span><code>oc delete -f RHELDeploy.yaml
</code></pre></div>
</li>
<li>
<p>Let's create our own custom SCC</p>
<div class="highlight"><pre><span></span><code>oc create -f readonly-scc.yaml
</code></pre></div>
<p>Let's examine the new SCC and see how it compares to <code>restricted</code></p>
<div class="highlight"><pre><span></span><code>oc describe scc read-only
</code></pre></div>
<p>It's very similar to <code>restricted</code> and the only major difference being that <code>Read Only Root Filesystem</code> is set to true now.</p>
</li>
<li>
<p>Create Service account</p>
<div class="highlight"><pre><span></span><code>oc create sa read-only
</code></pre></div>
</li>
<li>
<p>Now, create a Role that allows us to use the SCC with a service account</p>
<div class="highlight"><pre><span></span><code>oc create -f readonly-role.yaml
</code></pre></div>
</li>
<li>
<p>Then create a RoleBinding that ties the <code>read-only</code> service account to the new role that was just created.</p>
<div class="highlight"><pre><span></span><code>oc create -f readonly-rolebinding.yaml
</code></pre></div>
</li>
<li>
<p>Before we try deploying the RHEL pod again we first need to specify in our deployment manifest (RHELDeploy.yaml) that we want to use our <code>read-only</code> service account to run the pod.</p>
<p>If you feel comfortable editing the file using <code>vi</code> you can edit the RHELDeploy.yaml file to remove the <code>#</code> on line 17. If not, here are some alternatives that you can copy and paste in the terminal:</p>
<p>This command depends on what operating system you are working on.</p>
<p>If on Linux (such as on IBM Cloud Shell) try:
<div class="highlight"><pre><span></span><code>sed -i <span class="s1">&#39;s/#//&#39;</span> RHELDeploy.yaml
</code></pre></div></p>
<p>If on MacOSx try:</p>
<div class="highlight"><pre><span></span><code>sed -i <span class="s1">&#39;&#39;</span> <span class="s1">&#39;s/#//&#39;</span> RHELDeploy.yaml
</code></pre></div>
</li>
<li>
<p>With the comment removed, we can now deploy the file.</p>
<p>First, let's take a look at the RHELDeploy.yaml file</p>
<div class="highlight"><pre><span></span><code>cat RHELDeploy.yaml
</code></pre></div>
<p>Examine the contents of the file and notice the <code>serviceAccountName:</code> field. This ensures that this service account will be used.</p>
<p>Deploy the application with:</p>
<div class="highlight"><pre><span></span><code>oc create -f RHELDeploy.yaml
</code></pre></div>
</li>
<li>
<p>Let's go ahead and exec into our pod like before and see what has changed</p>
<ol>
<li>
<p>Get all pods</p>
<div class="highlight"><pre><span></span><code>oc get pods
</code></pre></div>
</li>
<li>
<p>Then, exec into the pod by running the following while replacing <code>{pod name}</code> with the actual pod name from the previous command:</p>
<div class="highlight"><pre><span></span><code>oc <span class="nb">exec</span> -it <span class="o">{</span>pod name<span class="o">}</span> -- bash
</code></pre></div>
</li>
<li>
<p>Once inside the pod, try a few commands to test out the permissions now:</p>
<p>Try creating a file in the root directory</p>
<div class="highlight"><pre><span></span><code>touch test.txt
</code></pre></div>
<p>That command still fails but now it should have a different message regarding operating as a "read-only file system"</p>
<p>Let's try creating a file in the "/tmp" directory now. This worked last time we tried with the default permissions.</p>
<div class="highlight"><pre><span></span><code>touch tmp/test.txt
</code></pre></div>
<p>This time the command doesn't work and we get the same error as the previous command about running in a "read-only file system".</p>
<p>What this means is that the running pod is now completely immutable; it cannot be modified maliciously. There is a caveat, however. Some applications actually rely on being able to write to the local file system. The workaround to this problem requires mounting a volume to write to instead.</p>
</li>
</ol>
</li>
</ol>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>In summary, this lab walked you through two different scenarios: using RBAC to create a helper service account to monitor workloads through the Kubernetes API, and using RBAC to ensure that service accounts can use custom SCCs to run pods.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: About the workshop" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              About the workshop
            </div>
          </div>
        </a>
      
      
        
        <a href="../resources/RESOURCES/" class="md-footer__link md-footer__link--next" aria-label="Next: Additional Resources" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Additional Resources
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 IBM Developer
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/ibm" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/ibmdeveloper" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ibm/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/user/developerworks" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://dev.to/ibmdeveloper" target="_blank" rel="noopener" title="dev.to" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.ddd52ceb.min.js"></script>
      
    
  </body>
</html>